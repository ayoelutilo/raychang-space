"use strict";class Portfolio{constructor(){this.backgroundMusicEl=document.querySelector(".background-music"),this.pagingSound=new Audio("https://raw.githubusercontent.com/rayc2045/raychang-space/master/audio/page.mp3"),this.typingSound=new Audio("https://raw.githubusercontent.com/rayc2045/raychang-space/master/audio/type.mp3"),this.loadingEl=document.querySelector(".loading"),this.viewportEl=document.querySelector(".viewport"),this.containerEl=document.querySelector(".container"),this.contactButton=document.querySelector(".contact"),this.contactEl=document.querySelector("#contact"),this.toTopButton=document.querySelector(".toTop"),this.dateEl=document.querySelector(".date"),this.worksEl=document.querySelector(".works"),this.formEl=document.querySelector("form"),this.inputEls=document.querySelectorAll("input"),this.textareaEls=document.querySelectorAll("textarea"),this.inputNameEl=document.querySelector(".input-name"),this.inputCompanyEl=document.querySelector(".input-company"),this.inputEmailEl=document.querySelector(".input-email"),this.inputSubjectEl=document.querySelector(".input-subject"),this.titleMessageEl=document.querySelector(".title-message"),this.textareaMessageEl=document.querySelector(".textarea-message"),this.sendButton=document.querySelector(".send"),this.sayHelloEl=document.querySelector(".say-hello"),this.appreciationEl=document.querySelector(".appreciation"),this.footerEl=document.querySelector("footer"),this.works=[{title:"Ghibli Gallery App",subtitle:"Remaster Studio Ghibli's Work Album with Vue 3.0",cover:"https://cdn.dribbble.com/users/3800131/screenshots/14489502/media/e740658dea07f7e82afa9e88d4dd880a.png",info:"https://github.com/rayc2045/ghibli-gallery",link:"https://rayc2045.github.io/ghibli-gallery/"},{title:"Horizontal Scrolling Theater",subtitle:"Enjoy the movie purchasing",cover:"https://cdn.dribbble.com/users/3800131/screenshots/11028118/media/8ba2db964d4f882bd59e50050cb09c46.png",info:"https://github.com/rayc2045/horizontal-scrolling-theater",link:"https://rayc2045.github.io/horizontal-scrolling-theater/"},{title:"Block Memory Game",subtitle:"How many levels can you accomplish?",cover:"https://cdn.dribbble.com/users/3800131/screenshots/10000193/media/5a5acc6684a86a5f46a9b4cd34f4df8e.gif",video:"https://github.com/rayc2045/block-memory-game/blob/main/demo.webm?raw=true",info:"https://github.com/rayc2045/block-memory-game",link:"https://rayc2045.github.io/block-memory-game/"},{title:"Vanilla Calculator",subtitle:"Elegantly shows the result immediately",cover:"https://cdn.dribbble.com/users/3800131/screenshots/6901484/_____2019-08-02___4.01.34.png",info:"https://github.com/rayc2045/vanilla-calculator",link:"https://rayc2045.github.io/vanilla-calculator/"},{title:"Draggable To-do List",subtitle:"Featured by autosave and markdown support",cover:"https://cdn.dribbble.com/users/3800131/screenshots/14655703/media/f45bd7c734c9acc23572c989a9703ef4.png",video:"https://github.com/rayc2045/draggable-todoList/blob/master/demo.webm?raw=true",info:"https://github.com/rayc2045/draggable-todoList",link:"https://rayc2045.github.io/draggable-todoList/"},{title:"Medium Blog",subtitle:"Read my latest technical article",cover:"https://raw.githubusercontent.com/rayc2045/raychang-space/master/img/medium-logo-transparent.png",link:"https://medium.com/@raychangdesign/"}],this.isTouchDevice="ontouchstart"in document.documentElement,this.bodyWidth=document.body.getBoundingClientRect().width,this.screenScale=this.bodyWidth/1280,this.isValidated=!1,this.events()}events(){this.preventScroll(),this.updateDate(),this.updateWorks(),this.parallax(),this.isTouchDevice||(this.activateHoverInteraction(this.worksEl,this.footerEl),this.smoothScroll()),document.onselectstart=()=>!1,document.ondragstart=()=>!1,document.oncontextmenu=()=>!1,document.onmouseup=e=>{e.target.hasAttribute("href")&&(this.soundPlay(this.pagingSound),3===e.which&&window.open(e.target.href,"_blank"))},this.containerEl.onmousedown=e=>this.appendCircle(e),this.contactButton.onmouseup=()=>{this.soundPlay(this.pagingSound),window.scrollTo(0,this.contactEl.getBoundingClientRect().top)},this.toTopButton.onmouseup=()=>{this.soundPlay(this.pagingSound),window.scrollTo(0,0)},this.formEl.onkeydown=()=>this.soundPlay(this.typingSound,.65),this.textareaEls.forEach(el=>{el.oninput=e=>{this.autoExpand(e),this.resizeBodyHeight()},el.onkeyup=e=>{this.autoExpand(e),this.resizeBodyHeight()},el.oncut=e=>{this.autoExpand(e),this.resizeBodyHeight()},el.onpaste=e=>{this.autoExpand(e),this.resizeBodyHeight()},el.onchange=e=>{this.autoExpand(e),this.resizeBodyHeight()}}),this.sendButton.onclick=e=>{this.submitForm(e),this.resizeBodyHeight()},window.onscroll=()=>this.putPackForm(),window.onload=()=>{this.resizeBodyHeight(),this.endLoading(),this.enableScroll()},window.onresize=()=>{this.resetParallax(),setTimeout(()=>this.resizeBodyHeight(),500)}}soundPlay(audio,volume=1){audio.currentTime=0,audio.volume=volume,audio.play()}appendCircle(e,duration=1.5){const circle=document.createElement("div");circle.classList.add("circle");const circleOffset=.25*document.body.getBoundingClientRect().width;let customCursorOffset=-.004*document.body.getBoundingClientRect().width;this.isTouchDevice&&(customCursorOffset=0),circle.style.left=`${e.pageX-circleOffset-customCursorOffset}px`,circle.style.top=`${e.pageY-circleOffset-customCursorOffset}px`,circle.style.animationDuration=`${duration}s`,this.containerEl.appendChild(circle),setTimeout(()=>this.removeElement(circle),1e3*duration)}removeElement(el){el.parentNode.removeChild(el)}preventScroll(){document.body.style.overflow="hidden"}enableScroll(){document.body.style.overflow=""}smoothScroll(){document.querySelector(".viewport").style.position="fixed",new SmoothScroll({target:this.containerEl,scrollEase:.08,maxOffset:500})}resetParallax(){this.bodyWidth=document.body.getBoundingClientRect().width,this.screenScale=this.bodyWidth/1280,ScrollTrigger.getAll().forEach(el=>el.kill()),this.parallax()}parallax(){this.gsapWithScrollTrigger(".circle-yellow",{y:1200*this.screenScale}),this.gsapWithScrollTrigger(".circle-orange",{y:2400*this.screenScale}),this.gsapWithScrollTrigger(".article-left",{y:200*this.screenScale}),this.gsapWithScrollTrigger(".article-right",{y:200*this.screenScale}),this.gsapWithScrollTrigger(".avatar",{y:-750*this.screenScale}),this.gsapWithScrollTrigger(".name",{y:-500*this.screenScale}),this.gsapWithScrollTrigger(".description",{y:-250*this.screenScale})}gsapWithScrollTrigger(className,animation,scrub=1){ScrollTrigger.create({animation:gsap.to(className,animation),scrub:scrub})}endLoading(){const delay=500;setTimeout(()=>this.loadingEl.classList.add("animated"),500),setTimeout(()=>this.removeElement(this.loadingEl),2500)}updateDate(){const today=new Date;let date=`${this.convertNumToMonth(today.getMonth()+1)} ${today.getDate()}, ${today.getFullYear()}`;this.dateEl.textContent=date}convertNumToMonth(num){return["January","February","March","April","May","June","July","August","September","October","November","December"][num-1]}updateWorks(){for(const i in this.works){const listEl=document.createElement("li");listEl.classList.add("work"),listEl.innerHTML=`\n\t\t\t\t<a href="${this.works[i].link}" target="_blank" rel="noreferrer noopener">\n\t\t\t\t\t${this.works[i].video?`<video autoplay loop muted playsinline>\n\t\t\t\t\t\t\t\t<source src="${this.works[i].video}">\n\t\t\t\t\t\t\t</video>`:`<img src="${this.works[i].cover}" alt="${this.works[i].title}" loading="lazy">`}\n        </a>\n        <section>\n          <div class="number">${this.addZeroToNumberUnderTen(this.works.length-i)}</div>\n          <div class="title">${this.works[i].title}</div>\n          <div class="subtitle">${this.works[i].subtitle}${this.works[i].info?` (<a class="info" href="${this.works[i].info}" target="_blank" rel="noreferrer noopener">info</a>)`:""}</div>\n\t\t\t\t</section>`,this.worksEl.appendChild(listEl)}}addZeroToNumberUnderTen(num){return num<10?"0"+num:""+num}activateHoverInteraction(...els){els.forEach(el=>el.classList.add("hover-interaction"))}autoExpand(e){const offset=e.target.offsetHeight-e.target.clientHeight;e.target.style.height="auto",e.target.style.height=e.target.scrollHeight+offset+"px"}resizeBodyHeight(){document.body.style.height=this.viewportEl.scrollHeight+"px"}submitForm(e){if(e.preventDefault(),this.isValidated=!0,this.checkForm(),!this.isValidated)return!1;this.emptyForm(),this.hideForm(),setTimeout(()=>{const receiver="rayc2045@gmail.com";window.open(`mailto:${receiver}?subject=${this.inputSubjectEl.value}&body=${this.textareaMessageEl.value}`,"_top")},800)}checkForm(){this.inputNameEl.value=this.removeTag(this.inputNameEl.value),this.inputCompanyEl.value=this.removeTag(this.inputCompanyEl.value),this.inputEmailEl.value=this.removeTag(this.inputEmailEl.value),this.inputSubjectEl.value=this.removeTag(this.inputSubjectEl.value),this.textareaMessageEl.value=this.removeTag(this.textareaMessageEl.value);const emailFormat=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;this.inputNameEl.value||(this.isValidated=!1,this.alertAnimate(this.inputNameEl.parentNode)),this.inputEmailEl.value.match(emailFormat)||(this.isValidated=!1,this.alertAnimate(this.inputEmailEl.parentNode)),this.inputSubjectEl.value||(this.isValidated=!1,this.alertAnimate(this.inputSubjectEl.parentNode)),this.textareaMessageEl.value||(this.isValidated=!1,this.alertAnimate(this.titleMessageEl),this.alertAnimate(this.textareaMessageEl.parentNode))}alertAnimate(el){el.classList.contains("alert")||(el.classList.add("alert"),setTimeout(()=>el.classList.remove("alert"),1e3))}removeTag(text){return String(text).trim().replace(/%3C/gi,"").replace(/(<([^>]+)>)/gi,"")}emptyForm(){this.inputEls.forEach(el=>{el.value=""}),this.textareaEls.forEach(el=>{el.style.height="auto",el.value=""})}hideForm(){this.sayHelloEl.classList.add("hide"),this.appreciationEl.classList.remove("hide")}putPackForm(){this.sayHelloEl.classList.contains("hide")&&(this.isInView(this.appreciationEl)||(this.sayHelloEl.classList.remove("hide"),this.appreciationEl.classList.add("hide")))}isInView(el){const elTop=~-el.getBoundingClientRect().top,elBottom=~-el.getBoundingClientRect().bottom;return elTop<window.innerHeight&&elBottom>=0}}new Portfolio;